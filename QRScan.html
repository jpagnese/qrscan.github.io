<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EmailJS Static Email with Dynamic Message</title>
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script>
    (function () {
      emailjs.init('cj0n6fbLDl-f4swPB'); // Replace with your actual Public Key
    })();
  </script>
  <style>
    #hidden-form {
      display: none;
    }
  </style>
</head>
<body>
  <h2>Please Wait...</h2>

  <form id="hidden-form">
    <input type="hidden" name="from_name" value="Static User">
    <input type="hidden" name="message" id="message">
    <input type="hidden" name="sent_time" id="sent_time">
    <input type="hidden" name="url_id" id="url_id">
  </form>

  <script>
    // Helper to get URL parameter
    function getUrlParameter(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    // Get ID from URL
    const idValue = getUrlParameter('ID') || 'an unknown user';

    // Build message
    const messageText = `The QRCode was scanned by ${idValue}`;

    // Timestamp
    const now = new Date();
    const formattedTime = now.toLocaleString();

    // Fill hidden fields
    document.getElementById('message').value = messageText;
    document.getElementById('sent_time').value = formattedTime;
    document.getElementById('url_id').value = idValue;

    // Send email when page loads
    window.onload = function () {
      emailjs.sendForm('service_hlkt43g', 'template_g7nwiii', '#hidden-form')
        .then(function () {
          window.location.href = 'http://jpagnese.github.io/qrscan.github.io/mywebsite.html';
        }, function (error) {
          alert('Something went wrong, please try again...\n' + JSON.stringify(error));
        });
    };
  </script>
</body>
</html>



